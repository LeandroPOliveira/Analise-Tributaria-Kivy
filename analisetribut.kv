#:import Factory kivy.factory.Factory

<Image>
    source: 'image.jpg'
    allow_stretch: True
    keep_ratio: False

<TelaLogin>:
    name: "login"

    FloatLayout:
        size: root.width, root.height

        Image:

        MDRectangleFlatButton:
            size_hint: (.6, .7)
            pos_hint: {'x': .2, 'y': .15}
            font_size: 20
            text_color:
            line_color: (0/255,174/255,0/255,1)
            md_bg_color: (1,1,1,1)


        Label:
            text: 'ANÁLISE TRIBUTÁRIA'
            pos_hint: {'x':0.4, 'y':0.65}
            color: (0,0,0,1)
            size_hint: (.2, .1)
            font_size: 30

        Label:
            text: 'Selecione a opção:'
            pos_hint: {'x':0.4, 'y':0.55}
            color: (43/255, 197/255, 232/255, 1)
            size_hint: (.2, .1)
            font_size: 25

        MDRectangleFlatButton:
            size_hint: (.15, .1)
            text: 'Análises \nPendentes'
            font_size: 22
            pos_hint: {'x':0.25, 'y':0.45}
            text_size: self.width, None
            text_color: (1,1,1,1)
            line_color: (1,1,1,1)
            md_bg_color: (0/255,174/255,0/255,1)
            on_release:
                app.root.current = 'pendentes'


        MDRectangleFlatButton:
            size_hint: (.15, .1)
            text: 'Nova Análise'
            font_size: 22
            pos_hint: {'x':0.425, 'y':0.45}
            text_size: self.width, None
            text_color: (1,1,1,1)
            line_color: (1,1,1,1)
            md_bg_color: (0/255,174/255,0/255,1)
            on_press:
                app.root.current = 'nova'

<AnalisesPendentes>:
    name: "pendentes"

    on_enter:
        self.add_datatable()

    MDIconButton:
        icon: 'arrow-left-bold-outline'
        icon_size: '50dp'
        pos_hint: {'x':0.01, 'y':0.9}
        theme_text_color: "Custom"
        text_color: (36/255,100/255,203/255,1)
        on_press:
            app.root.current = 'login'
            root.manager.transition.direction = 'right'

    MDBoxLayout:
        orientation: 'vertical'
        padding: 10


        AnchorLayout:
            id: data_layout


<MDTextField>
    mode: "rectangle"
    size_hint: (.15, .08)
    line_color_normal: [0,0,0,1]
    text_color_normal: 0, 0, 0, 1
    text_color_focus: 0, 0, 0, 1
    write_tab: False

<MDLabel>
    font_size: 20
    size_hint: .2, .1
    halign: 'left'
    color: (11/255, 156/255, 49/255, 1)

<Check@MDCheckbox>:
    group: 'group'
    size_hint: None, None
    size: dp(48), dp(48)


<NovaAnalise>:
    name: 'nova'

    on_enter:
        root.tabela_materiais()
        root.campos_serv()
        root.clausulas()



    ScrollView:
        bar_width: 10


        BoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: 4000

            canvas.before:
                Rectangle:
                    pos: self.pos
                    size: self.size
                    source: "image3.jpg"

            GridLayout:
                cols:1
                size_hint: 1, .20


                FloatLayout:

                    size: root.width, root.height


                    MDLabel:
                        text: 'Análise Contábil e Tributária para Processos de Licitação e ou Contratação Direta'
                        pos_hint: {'x':0.1, 'y':0.85}
                        size_hint: .8, .2
                        halign: 'center'


                    MDIconButton:
                        icon: 'arrow-left-bold-outline'
                        icon_size: '50dp'
                        pos_hint: {'x':0.01, 'y':0.9}
                        theme_text_color: "Custom"
                        text_color: (36/255,100/255,203/255,1)
                        on_press:
                            app.root.current = 'login'
                            root.manager.transition.direction = 'right'

                    MDRectangleFlatButton:
                        size_hint: (.8, .4)
                        pos_hint: {'x': .1, 'y': .5}
                        font_size: 20
                        text_color:
                        line_color: (0/255,174/255,0/255,1)
                        md_bg_color: (1,1,1,1)
                        ripple_scale: 0


                    MDTextField:
                        id: gere
                        hint_text: "Gerência Contratante"
                        pos_hint: {'x':0.2, 'y':0.80}


                    MDTextField:
                        id: proc
                        hint_text: 'Nº Processo GECBS'
                        helper_text: 'Ex: DV-001-2022'
                        pos_hint: {'x':0.425, 'y':0.8}


                    MDTextField:
                        id: req
                        hint_text: 'Requisição de Compras'
                        pos_hint: {'x':0.65, 'y':0.8}

                    MDTextField:
                        id: objcust
                        hint_text: 'Objeto de Custos:'
                        helper_text: 'Opções: Elemento PEP ou Centro Custo'
                        pos_hint: {'x':0.2, 'y':0.7}


                    MDLabel:
                        text: 'Consta Orçamento:'
                        pos_hint: {'x':0.42, 'y':0.68}
                        size_hint: .2, .1
                        halign: 'center'

                    MDLabel:
                        text: 'Sim'
                        pos_hint: {'x':0.6, 'y':0.68}
                        size_hint: .2, .1
                        halign: 'center'

                    MDLabel:
                        text: 'Não'
                        pos_hint: {'x':0.69, 'y':0.68}
                        size_hint: .2, .1
                        halign: 'center'

                    Check:
                        id: orcam_sim
                        ripple_scale: 0
                        pos_hint: {'x': 0.64, 'y': 0.7}

                    Check:
                        id: orcam_nao
                        ripple_scale: 0
                        pos_hint: {'x': 0.735, 'y': 0.7}


                    MDLabel:
                        text: 'Tipo de Análise:'
                        size_hint: (.2, .1)
                        text_size: self.size
                        valign: 'center'
                        halign: 'left'
                        pos_hint: {'x':0.4, 'y':0.6}
                        color: (43/255, 197/255, 232/255, 1)
                        font_size: 20
                        padding: 10, 10

                    MDSwitch:
                        group: 'group'
                        id: check1
                        ripple_scale: 0
                        pos_hint: {'center_x': 0.2, 'center_y': 0.575}

                    MDSwitch:
                        #group: 'group'
                        id: check2
                        ripple_scale: 0
                        pos_hint: {'center_x': 0.425, 'center_y': 0.575}

                    MDSwitch:
                        #group: 'group'
                        id: check2
                        ripple_scale: 0
                        pos_hint: {'center_x': 0.625, 'center_y': 0.575}

                    MDLabel:
                        text: 'Serviço'
                        pos_hint: {'x':0.225, 'y':0.525}

                    MDLabel:
                        text: 'Material'
                        pos_hint: {'x':0.45, 'y':0.525}


                    MDLabel:
                        text: 'Serviço com Fornc. Material'
                        pos_hint: {'x':0.65, 'y':0.525}


                    MDRectangleFlatButton:
                        size_hint: (.8, .4)
                        pos_hint: {'x': .1, 'y': .05}
                        font_size: 20
                        text_color:
                        line_color: (0/255,174/255,0/255,1)
                        md_bg_color: (1,1,1,1)
                        ripple_scale: 0

                    MDLabel:
                        text: 'Objeto da Contratação:'
                        size_hint: (.2, .1)
                        pos_hint: {'x':0.2, 'y':0.35}

                    MDTextField:
                        id: objeto
                        multiline: True
                        hint_text: "Descrição"
                        pos_hint: {'x':0.2, 'y':0.225}
                        size_hint: (.25, .15)
                        write_tab: False

                    MDLabel:
                        text: 'Informações Complementares:'
                        size_hint: (.3, .1)
                        pos_hint: {'x':0.55, 'y':0.35}

                    MDTextField:
                        id: complem
                        multiline: True
                        hint_text: "Descrição"
                        pos_hint: {'x':0.55, 'y':0.225}
                        size_hint: (.25, .15)
                        fill_color: 0, 0, 0, .4
                        write_tab: False

                    MDTextField:
                        id: valor
                        multiline: True
                        hint_text: "Valor Estimado"
                        pos_hint: {'x':0.425, 'y':0.105}
                        size_hint: (.15, .08)
                        fill_color: 0, 0, 0, .4
                        write_tab: False

            GridLayout:
                cols:1
                size_hint: 1, .05

                FloatLayout:

                    size: root.width, root.height

                    MDLabel:
                        text: 'Informações Tributárias - Materiais'
                        size_hint: .3, .1
                        pos_hint: {'x':0.4, 'y':0.6}



                    Check:
                        id: check_iva
                        ripple_scale: 0
                        pos_hint: {'x': 0.49, 'y': 0.12}
                        group: False
                        on_active:
                            root.preenche_iva()

                    Check:
                        id: check_ncm
                        ripple_scale: 0
                        pos_hint: {'x': 0.57, 'y': 0.12}
                        group: False
                        on_active:
                            root.preenche_ncm()

                    Check:
                        id: check_impostos
                        ripple_scale: 0
                        pos_hint: {'x': 0.73, 'y': 0.12}
                        group: False
                        on_active:
                            root.preenche_aliq()


                    MDLabel:
                        text: 'Código'
                        pos_hint: {'x':0.185, 'y':0.02}

                    MDLabel:
                        text: 'Descrição'
                        pos_hint: {'x':0.325, 'y':0.02}

                    MDLabel:
                        text: 'IVA'
                        pos_hint: {'x':0.485, 'y':0.02}

                    MDLabel:
                        text: 'NCM'
                        pos_hint: {'x':0.565, 'y':0.02}

                    MDLabel:
                        text: 'ICMS'
                        pos_hint: {'x':0.64, 'y':0.02}

                    MDLabel:
                        text: 'IPI'
                        pos_hint: {'x':0.7, 'y':0.02}

                    MDLabel:
                        text: 'PIS'
                        pos_hint: {'x':0.75, 'y':0.02}

                    MDLabel:
                        text: 'COFINS'
                        pos_hint: {'x':0.79, 'y':0.02}


            GridLayout:
                cols:1
                size_hint: 1, .1


                ScrollView:
                    size_hint: .8, .1
                    size: (self.width, 500)
                    bar_margin: 150
                    bar_width: 10
                    scroll_type: ['bars', 'content']

                    GridLayout:
                        id: grid_teste
                        size_hint_y: None
                        height: self.minimum_height
                        row_default_height: 30
                        cols: 8
                        rows: 30
                        bar_width: 50
                        padding: [200, 0, 200, 0]



            GridLayout:
                cols:1
                size_hint: 1, .05

                FloatLayout:

                    MDRectangleFlatButton:
                        text: 'Limpar Campos'
                        font_size: 18
                        pos_hint: {'x': .45, 'y': .7}
                        size_hint: .1, .15
                        text_color: (1,1,1,1)
                        line_color: (1,1,1,1)
                        md_bg_color: (0/255,174/255,0/255,1)
                        on_press:
                            root.limpar()

                    MDLabel:
                        text: 'Informações Tributárias - Serviços'
                        pos_hint: {'x': .35, 'y': .2}
                        size_hint: .3, .1
                        halign: 'center'

            GridLayout:
                cols:1
                size_hint: 1, .12

                FloatLayout:

                    size: root.width, root.height

                    MDRectangleFlatButton:
                        size_hint: (.7, .8)
                        pos_hint: {'x': .15, 'y': .15}
                        font_size: 20
                        text_color:
                        line_color: (0/255,174/255,0/255,1)
                        md_bg_color: (1,1,1,1)
                        ripple_scale: 0

                    MDTextField:
                        id: cod_serv
                        hint_text: "Código Serviço"
                        pos_hint: {'x':0.2, 'y':0.75}
                        size_hint: (.1, .15)

                    MDTextField:
                        id: serv
                        hint_text: "Descrição"
                        pos_hint: {'x':0.35, 'y':0.4}
                        size_hint: (.45, .5)
                        write_tab: False
                        multiline: True
                        cursor_home: True
                        on_focus:
                            root.busca_servico()

                    MDTextField:
                        id: iva
                        hint_text: "Código IVA"
                        pos_hint: {'x':0.2, 'y':0.2}
                        size_hint: (.1, .15)

                    MDLabel:
                        text: 'Código'
                        pos_hint: {'x':0.28, 'y':0}

                    MDLabel:
                        text: 'Descrição'
                        pos_hint: {'x':0.47, 'y':0}

                    MDLabel:
                        text: 'C.C.'
                        pos_hint: {'x':0.68, 'y':0}



            GridLayout:
                cols:1
                size_hint: 1, .08

                ScrollView:
                    size_hint: .8, .1
                    size: (self.width, 500)
                    bar_margin: 150
                    bar_width: 10
                    scroll_type: ['bars', 'content']

                    GridLayout:
                        id: grid_serv
                        size_hint_y: None
                        height: self.minimum_height
                        row_default_height: 30
                        cols: 3
                        rows: 60
                        bar_width: 50
                        padding: [300, 0, 300, 0]




            GridLayout:
                cols:1
                size_hint: 1, .2

                BoxLayout:
                    orientation: 'vertical'
                    padding: [450, 50, 450, 50]
                    spacing: 20
                    size: root.width, root.height


                    MDLabel:
                        text: 'Observações'
                        halign: 'center'
                        size_hint: (1, .1)

                    MDTextField:
                        id: obs
                        hint_text: "Obs. Materiais"
                        size_hint: (1, .2)

                    MDTextField:
                        id: obs
                        hint_text: "Obs. Serviços"
                        size_hint: (1, .2)

                    MDTextField:
                        id: obs
                        hint_text: "Obs. 1"
                        size_hint: (1, .2)

                    MDTextField:
                        id: obs
                        hint_text: "Obs. 2"
                        size_hint: (1, .2)

            GridLayout:
                cols:1
                size_hint: 1, .03

                FloatLayout:

                    MDLabel:
                        text: 'Informações Contratuais:'
                        pos_hint: {'x': .35, 'y': .4}
                        size_hint: .3, .1
                        halign: 'center'

            GridLayout:
                cols:1
                size_hint: 1, .12

                ScrollView:
                    size_hint: .8, .1
                    size: (self.width, 500)
                    bar_margin: 150
                    bar_width: 10
                    scroll_type: ['bars', 'content']

                    GridLayout:
                        id: grid_clausulas
                        size_hint_y: None
                        height: self.minimum_height
                        row_default_height: 100
                        cols: 3
                        rows: 17
                        bar_width: 50
                        padding: [250, 0, 250, 0]
                        spacing: 20

            GridLayout:
                cols:1
                size_hint: 1, .05

                FloatLayout:

                    size: root.width, root.height

                    MDRectangleFlatButton:
                        text: 'Gerar PDF'
                        font_size: 18
                        pos_hint: {'x': .6, 'y': .5}
                        size_hint: .1, .15
                        text_color: (1,1,1,1)
                        line_color: (1,1,1,1)
                        md_bg_color: (0/255,174/255,0/255,1)
                        on_press:

                    MDRectangleFlatButton:
                        text: 'Enviar Email'
                        font_size: 18
                        pos_hint: {'x': .3, 'y': .5}
                        size_hint: .1, .15
                        text_color: (1,1,1,1)
                        line_color: (1,1,1,1)
                        md_bg_color: (0/255,174/255,0/255,1)
                        on_press:


WindowManager:

    TelaLogin:

    AnalisesPendentes:

    NovaAnalise:
